<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="$(var.ProjectFullName) ($(var.Platform))" Language="1033" Version="$(var.VersionNbr)" Manufacturer="Example Inc." UpgradeCode="671ff6e7-da06-414f-a0e6-d8626a7bd12c">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" Description="Version:$(var.VersionNbr)" />

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate EmbedCab="yes" />

		<Feature Id="ProductFeature" Title="$(var.ProjectName)Setup" Level="1">

			<!-- ($var.ProjectName)_Project is the list of all files generated by dotnet publish. It's in ($var.ProjectName).wxs, 
			     which is in turn generated as a BeforeBuild target and can be found in the main WiX project file, WiX Setup.wixproj.
				 The standalone does not require the .NET Core 3.1 runtime to be installed -->
			<ComponentGroupRef Id="$(var.ProjectName)_Project" />
		</Feature>
	</Product>

	<!-- Install to C:\Program Files\ or C:\Program Files (x86) depending on the platform we choose -->
	<!-- Credit goes to StackOverflow user Dan, https://stackoverflow.com/questions/1929038/compilation-error-ice80-the-64bitcomponent-uses-32bitdirectory -->
	<!-- GitHub user DanJBower -->
	<?if $(var.Platform) = x64 ?>
	<?define Win64 = "yes" ?>
	<?define PlatformProgramFilesFolder = "ProgramFiles64Folder" ?>
	<?else ?>
	<?define Win64 = "no" ?>
	<?define PlatformProgramFilesFolder = "ProgramFilesFolder" ?>
	<?endif ?>

	<!-- Set the installation directory here-->
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="$(var.PlatformProgramFilesFolder)">
				<Directory Id="INSTALLFOLDER" Name="$(var.ProjectFullName)" />
			</Directory>
		</Directory>
	</Fragment>
</Wix>
